<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Ergebnisseite</title>
		<link href="/css/stylesheet.css" rel="stylesheet" />
		<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
		
		<script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
		<script type="text/javascript" src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	</head>
	<style>
		#myTable tbody tr:hover td, .table-hover tbody tr:hover th {
			background-color: rgb(70, 138,214);
			transition:color .1s ease-out, background .1s ease-in;
		}
		
		
		#myTable {
		    border-collapse: collapse;
		}
		
		th, td {
		    padding: 5px;
		    text-align: left;
		    white-space: nowrap;    
		}
		
		.myTable-cursor {
			cursor: pointer;
		}
		
		.myTable-cursor:hover {
			color: white;
		}
		
		.document__content {
			padding-bottom: 100px;
		}
		
		.showDetail {
			cursor: pointer;
		}
		
		body {
			background: white;
		}
		
		/*damit könnte man global restrikten, dass nur die ersten 3 listenelementen angezeigt werden*/
		.version-value li:nth-child(n+4) {
		    display:none;
		}
		
		#detail-card-details {
			width: 100%;
		    height: 0px;
		}
		
		#detail-card-details.active {
			transition: height 0s;
		    height: 300px;
		}
		
		#loadingmask
		{
		    width: 100%;
		    height: 100%;
		    position: fixed;
		    top:0;
		    background: white;
		    z-index: 100;
		}
		
		/*Overlay adapted von https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_overlay*/
		#overlay {
			position: fixed;
		    display: none;
		    width: 100%;
		    height: 100%;
		    top: 0;
		    left: 0;
		    right: 0;
		    bottom: 0;
		    background-color: rgba(0,0,0,0.85);
		    z-index: 2;
		}
		
		/*Übernommen von hier: https://stackoverflow.com/questions/44837577/how-to-change-the-default-hover-style-of-pagination-buttons-in-datatables*/
		
		.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
			background: rgb(70, 138,214);
			color: white!important;
			border:none;
		}
		
		
		.dataTables_wrapper .dataTables_paginate .paginate_button:active {
			background: none;
			color: black!important;
		}
	</style>
	<body>
		<div id="overlay"></div>
		<div id="loadingmask"></div>
		<header>
			<div class="header" >
				<a href="/"><img src="/images/logo v01 mit rand.png" alt="logo" class="logo" width="200px"/></a>
				<nav>
					<ul id="menu">
						<li><a href="/detektion"><strong>Detektor</strong></a></li>
						<li><a href="/suche"><strong>Suche</strong></a></li>
					</ul>
				</nav>
			</div>
		</header>
		<br><br><br><br><br>
		<div class="document">
			<h3>Folgende Schwachstellen wurden in NVD Datenbank identifiziert:</h3>
			<a href="/suche">Neue Suche starten</a>
			<br>
			<div class="hideThis" id="div1">
				<div class="detail-card"> 
					<br>
					<table class="detail-card-table" style="width: 100%;">
						<tr>
							<td><h3>Details zur Schwachstelle</h3></td>
							<td><button type="button" id="close-detail-card" class="showDetail" target="2" onclick="off()" style="display: block; margin: 0 auto; border: 0px solid transparent; outline: none; color: rgb(83, 138,214); background-color: white;"><strong>X</strong></button>
						</tr>
					</table>
					<br>
					<table class="detail-card-table" style="width: 100%;">
						<tr>
							<td><img src="/images/Icon Vendor Name.jpg" align="right" style="max-height:80px;"></td>
							<td>VENDOR NAME<br> <textarea readonly name="text" id="2" class="detail-card-text" placeholder="unknown" style="width:95%;outline: none;"></textarea></td>
							<td></td>
							<td><img src="/images/Icon Product Name.jpg" align="right" style="max-height:80px;"></td>
							<td>PRODUCT NAME<br> <textarea readonly name="text" id="0" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
							<td></td>
							<td><img src="/images/Icon Version.jpg" align="right" style="max-height:80px;"></td>
							<td>VERSION<br> <textarea readonly name="text" id="13" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
						</tr>
						<tr> 
							<td> </td>
							<td> </td>
							<td> </td>
							<td> </td>
						</tr>
						<tr>
							<td><img src="/images/Icon ID.jpg" align="right" style="max-height:80px;"></td>
							<td>ID<br> <textarea readonly name="text" id="1" class="detail-card-text" placeholder="unknown" style="width:95%;outline: none;"></textarea></td>
							<td></td>
							<td><img src="/images/Icon Last Modified.jpg" align="right" style="max-height:80px;"></td>
							<td>LAST MODIFIED<br> <textarea readonly name="text" id="6" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
							<td></td>
							<td><img src="/images/Icon Score.jpg" align="right" style="max-height:80px;"></td>
							<td>SCORE<br> <textarea readonly name="text" id="4" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
						</tr>
					</table>	
					<br>
					PROBLEM VALUE<br> <textarea readonly name="text" id="5" class="detail-card-text" placeholder="unknown" style="height: 80px;outline: none;"></textarea><br>
					<table id="detail-card-table" style="width:100%;">
						<tr>
							<td>CPE MATCH<br> <textarea readonly name="text" id="7" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
							<td>PUBLISH DATE<br> <textarea readonly name="text" id="8" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
							<td>ASSIGNER<br> <textarea readonly name="text" id="12" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
						</tr>
						<tr>
							<td>DATA TYPE<br> <textarea readonly name="text" id="9" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
							<td>DATA FORMAT<br> <textarea readonly name="text" id="10" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
							<td>DATA VERSION<br> <textarea readonly name="text" id="11" class="detail-card-text" placeholder="unknown" style="outline: none;"></textarea></td>
						</tr>
						<tr>
							<td></td>
							<td></td>
							<td></td>
						</tr>
					</table>
				</div>
			</div>
			<div class="document__content">
				<br>
				<table id="myTable" class="table table-striped table-bordered table-sm" style="width: 100%;">
					<thead>
						<tr>
							<th>Product Name</th>
							<th>ID</th>
							<th>Vendor Name</th>
							<th>Version</th>
							<th>Accuracy (in %)</th>
							<th style="display:none;">Problem Value</th>
							<th style="display:none;">Last Modified</th>
							<th style="display:none;">CPE Match</th>
							<th style="display:none;">Publish Date</th>
							<th style="display:none;">Data Type</th>
							<th style="display:none;">Data Format</th>
							<th style="display:none;">Data Version</th>
							<th style="display:none;">Assigner</th>
							<th style="display:none;"></th>
						</tr>
					</thead>
					<tbody>
						 <tr th:each="entry : ${output}" class="myTable-cursor">
							<td th:text="${entry.product_name}" class="showDetail" target="1"></td>
							<td th:text="${entry.id}" class="showDetail" target="1"></td>
							<td th:text="${entry.vendor_name}" class="showDetail" target="1"></td>
							<td><ul class="version-value" style="list-style-type: none;"><li th:each="version : ${entry.version_value}" style=""><p th:text="${version}"class="showDetail" target="1"></p></li></ul></td>
							<td th:text="${entry.score}" class="showDetail" target="1"></td>
							<td th:text="${entry.problem_value}" style="display:none;"></td>
							<td th:text="${entry.lastModified}" style="display:none;"></td>
							<td th:text="${entry.cpe_match}" style="display:none;"></td>
							<td th:text="${entry.publishDate}" style="display:none;"></td>
							<td th:text="${entry.data_type}" style="display:none;"></td>
							<td th:text="${entry.data_format}" style="display:none;"></td>
							<td th:text="${entry.data_version}" style="display:none;"></td>
							<td th:text="${entry.assigner}" style="display:none;"></td>
							<td style="display:none;"><ul><li th:each="version : ${entry.version_value}"><p th:text="${version}"class="showDetail" target="1"></p></li></ul></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div id="footer"><img alt="footer" src="/images/footer.jpg" style="width:100%"></div>
		<button onclick="backToTop()" id="back-to-top-button">Δ</button>
	</body>
	<script>
		$('#loadingmask').fadeOut(500, function(){ $(this).remove(); });
		
		//Funktion für das Schließen und öffnen der Detailkarte
			jQuery(function() {
				jQuery('.showDetail').click(function() {
					on();
					jQuery('.hideThis').hide();
					jQuery('#div' + $(this).attr('target')).show();
				});
			});
			
		//Funktion für die default geschlossene Detailkarte
			jQuery(function(){
				   jQuery('#close-detail-card').click();
				});
		
		//Funktionen, um Infos in der Detailkarte anzuzeigen
		
			var table = document.getElementById('myTable'), rIndex;
			for (var i = 1; i < table.rows.length; i++) {
				table.rows[i].onclick = function() {
					rIndex = this.rowIndex;
					document.getElementById("0").value = this.cells[0].innerHTML;
					document.getElementById("1").value = this.cells[1].innerHTML;
					document.getElementById("2").value = this.cells[2].innerHTML;
					document.getElementById("13").value = this.cells[13].innerText;
					document.getElementById("4").value = this.cells[4].innerHTML;
					document.getElementById("5").value = this.cells[5].innerHTML;
					document.getElementById("6").value = this.cells[6].innerHTML;
					document.getElementById("7").value = this.cells[7].innerHTML;
					document.getElementById("8").value = this.cells[8].innerHTML;
					document.getElementById("9").value = this.cells[9].innerHTML;
					document.getElementById("10").value = this.cells[10].innerHTML;
					document.getElementById("11").value = this.cells[11].innerHTML;
					document.getElementById("12").value = this.cells[12].innerHTML;
				};
			}
			
		// Funktionen für das Erweitern der Detailkarte
		
		function open_notification() 
		{
		//    this.setState({
		//        showNotification: !this.state.showNotification,
		//    });
		     document.getElementById("detail-card-details").className += " active";
		     document.getElementById("detail-card-table2").className += " active";
		     if ($("#detail-card-toggle").text() == "Mehr anzeigen")
		     {			
		       $("#detail-card-toggle").html("Weniger anzeigen")
		     }
			  else 
		     {		
		       $("#detail-card-toggle").text("Mehr anzeigen")
		       document.getElementById("detail-card-details").className -= " active";
		       document.getElementById("detail-card-table2").className -= " active";
		     }
		}
			
		// Overlay von https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_overlay
		
		function on() {
		  document.getElementById("overlay").style.display = "block";
		}
		
		function off() {
		  document.getElementById("overlay").style.display = "none";
		}
		// Back-to-top-button
		window.onscroll = function() {scrollFunc()};
		
		function scrollFunc() {
		  if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
		    document.getElementById("back-to-top-button").style.display = "block";
		  } else {
		    document.getElementById("back-to-top-button").style.display = "none";
		  }
		}
		
		function backToTop() {
		  	if(navigator.userAgent.indexOf("Safari/") == -1){
				document.documentElement.scrollTop = 0; 
			} else if(navigator.userAgent.indexOf("Chrome/") != -1){
		  			document.documentElement.scrollTop = 0; 
		  	} else {
		  		document.body.scrollTop = 0;
		  	}
		}
		
		//Bootstrap tabelle aufrufen
		$(document).ready(function() {
			$('#myTable').dataTable();
		});
	</script>
</html>