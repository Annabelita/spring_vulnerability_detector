package matching;

import java.util.PriorityQueue;
import document.Vulnerability;

// Klasse, die Vulnerability mit zugehörigem Score speichert
public class AccuracyVulnerability implements Comparable<AccuracyVulnerability> {

	public double accuracy;
	public Vulnerability vul;

	public AccuracyVulnerability(Vulnerability vul, double accuracy) {

		this.accuracy = accuracy;
		this.vul = vul;

	}

	// für die PriorityQueue
	@Override
	public int compareTo(AccuracyVulnerability accVul) {
		return Double.compare(accVul.accuracy, this.accuracy);
	}

	// Main-Methode für Testzwecke
	public static void main(String arg[]) {
		PriorityQueue<AccuracyVulnerability> prioQueue = new PriorityQueue<AccuracyVulnerability>();

		Vulnerability vul1 = new Vulnerability();
		Vulnerability vul2 = new Vulnerability();
		Vulnerability vul3 = new Vulnerability();
		Vulnerability vul4 = new Vulnerability();
		Vulnerability vul5 = new Vulnerability();
		Vulnerability vul6 = new Vulnerability();
		Vulnerability vul7 = new Vulnerability();

		vul1.setProduct_name("Apple");
		vul2.setProduct_name("Cisco");
		vul3.setProduct_name("Python");
		vul4.setProduct_name("Microsoft");
		vul5.setProduct_name("Linux");
		vul6.setProduct_name("Windows");
		vul7.setProduct_name("Android");

		AccuracyVulnerability accVul1 = new AccuracyVulnerability(vul1, 17);
		AccuracyVulnerability accVul2 = new AccuracyVulnerability(vul2, 15);
		AccuracyVulnerability accVul3 = new AccuracyVulnerability(vul3, 13);
		AccuracyVulnerability accVul4 = new AccuracyVulnerability(vul4, 4);
		AccuracyVulnerability accVul5 = new AccuracyVulnerability(vul5, 100);
		AccuracyVulnerability accVul6 = new AccuracyVulnerability(vul6, 100);
		AccuracyVulnerability accVul7 = new AccuracyVulnerability(vul7, 100);

		prioQueue.add(accVul1);
		prioQueue.add(accVul2);
		prioQueue.add(accVul3);
		prioQueue.add(accVul4);

		int numberOfOutputs = 3;
		AccuracyVulnerability accVulCheck;
		while ((accVulCheck = prioQueue.poll()) != null) {

			if (accVulCheck.accuracy == 100) {
				numberOfOutputs = 0;
				System.out.println(accVulCheck.vul.product_name + " " + accVulCheck.accuracy);
				continue;
			} else if (numberOfOutputs == 0 || accVulCheck.accuracy < 15) {
				break;
			} else {
				System.out.println(accVulCheck.vul.product_name + " " + accVulCheck.accuracy);
				numberOfOutputs--;
			}

		}

	}

}
